---
title: Gender differences in collaboration patterns in computer science
bibliography: ../sysconf.bib
simplesummary: |
  A Simple summary goes here.
abstract: |
  A single paragraph of about 200 words maximum. For research articles,
  abstracts should give a pertinent overview of the work. We strongly encourage
  authors to use the following style of structured abstracts, but without
  headings: 1) Background: Place the question addressed in a broad context and
  highlight the purpose of the study; 2) Methods: Describe briefly the main
  methods or treatments applied; 3) Results: Summarize the article's main
  findings; and 4) Conclusion: Indicate the main conclusions or interpretations.
  The abstract should be an objective representation of the article, it must not
  contain results which are not presented and substantiated in the main text and
  should not exaggerate the main conclusions.
keywords: |
  keyword 1; keyword 2; keyword 3 (list three to ten pertinent keywords specific
  to the article, yet reasonably common within the subject discipline.).
acknowledgement: |
  All sources of funding of the study should be disclosed. Please clearly
  indicate grants that you have received in support of your research work.
  Clearly state if you received funds for covering the costs to publish in open
  access.
authorcontributions: |
  For research articles with several authors, a short paragraph specifying their
  individual contributions must be provided. The following statements should be
  used ``X.X. and Y.Y. conceive and designed the experiments; X.X. performed the
  experiments; X.X. and Y.Y. analyzed the data; W.W. contributed
  reagents/materials/analysis tools; Y.Y. wrote the paper.'' Authorship must be
  limited to those who have contributed substantially to the work reported.
conflictsofinterest: |
  The authors declare no conflict of interest.
funding: |
  SJREF
institutionalreview: |
  IRB number
informedconsent: |
  Any research article describing a study involving humans should contain this statement. Please add ``Informed consent was obtained from all subjects involved in the study.'' OR ``Patient consent was waived due to REASON (please provide a detailed justification).'' OR ``Not applicable'' for studies not involving humans. You might also choose to exclude this statement if the study did not involve humans.
dataavailability: |
  github, doi, supplemental
output:
  bookdown::pdf_book:
    keep_tex: true
    template: main.tex
    citation_package: natbib
    fig_caption: true
---

```{r code = readLines("../load_data.R"), echo = F, message = F}
```

```{r setup, echo=F, message=F, warning=F, cache=T}
library('rjson')
library('kableExtra')

# This function reads in a .json conference file and for each paper in the conference it extracts the author names, paper id,
# field, and conference id into a data frame. It then normalizes the names using 'normalized_author_name' and moves
# on to the next paper, stacking the new data frame with those that have already been created each time.
# Finally it normalizes the author names and joins with a gender mapping df to get the corresponding genders.

json_to_df <- function(conf_name, gender_mapping) {
  json_fpath <- paste0(toplevel, "data/conf/", conf_name, ".json")
  conf <- rjson::fromJSON(file = json_fpath)
  confname <- conf[[1]]
  field <- conf[['field']]
  subfield <- conf[['subfield']]
  papers <- conf[['papers']]
  submissions <- conf[['submissions']]

  conf_info_df <- data.frame()

  for (i in seq_along(papers)) {
    paper_id <- unlist(papers[[i]][1])
    authors <- as.data.frame(papers[[i]][3]) %>%
      mutate(conf = confname,
             field = field,
             subfield = subfield,
             paper_id = paper_id,
             n_submissions = submissions)

    conf_info_df <- bind_rows(conf_info_df, authors)
  }

  conf_info_df <- conf_info_df %>%
    mutate(authors = map_chr(authors, normalized_author_name)) %>%
    mutate(authors = str_replace(authors, "\\s+", " ")) %>%
    mutate(paper_id = as.factor(paper_id)) %>%
    rename(name = authors)

  conf_info_df %>%
    left_join(gender_mapping, by = "name")
}

######################
# Here we create a vector of the conference names and use the 'map_dfr' function to apply 'json_to_df' to each conference.
nonsys_confs <-
  c("AAAI", "ACL", "CHI", "CVPR", "FSE", "ICML", "ICSE", "MM", "NIPS", "POPL", "SIGCSE", "SIGGRAPH", "SODA", "STOC", "WSDM", "WWW", "ITICSE", "FOCS", "TACAS")

nonsys_authors <- nonsys_confs %>%
  map_dfr(~json_to_df(.x, all_genders)) %>%
  mutate(across(.cols = everything(), na_if, "NA")) %>%
  mutate(across(c(field, subfield, gender), factor))
  

###########
name_combination_creator <- function(df)
{
  authors <- df$name
  if (length(authors) <= 1) {
    return (data.frame(name1 = c(), name2 = c()))
  }

  ret <- as.data.frame(t(combn(authors, 2)))
  names(ret) <- c("name1", "name2")
  ret <- rbind(ret, data.frame(name1 = ret$name2, name2 = ret$name1))
  return(ret)
}

#######
# All-to-all coauthor pairs for non-sys and for sys:
nonsys_collaboration_pairs <- nonsys_authors %>%
  group_by(paper_id) %>%
  group_modify(~name_combination_creator(.x)) %>%
  ungroup() %>%
  left_join(all_genders, by = c("name2" = "name")) %>%
  rename(gender2 = gender) %>%
  left_join(all_genders, by = c("name1" = "name")) %>%
  rename(gender1 = gender) %>%
  dplyr::select(paper_id, name1, gender1, name2, gender2)

sys_collaboration_pairs <- coauthors %>%
  left_join(persons, by = c("name1" = "name", "gs_email1" = "gs_email")) %>%
  rename(gender1 = gender, paper_id = paper) %>%
  left_join(persons, by = c("name2" = "name", "gs_email2" = "gs_email")) %>%
  rename(gender2 = gender) %>%
  dplyr::select(paper_id, name1, gender1, name2, gender2) %>%
  distinct(name1, name2, paper_id, .keep_all = T)

all_pairs <- rbind(nonsys_collaboration_pairs, sys_collaboration_pairs)

#####################
gender_summary_table <- function(data)
{
  data %>%
    summarise(.groups = "keep",
      n_papers = n_distinct(paper_id, conf),
      n_na = sum(is.na(gender)),
      n_male = sum(gender == "M", na.rm = T),
      n_female = sum(gender == "F", na.rm = T),
      prop_female = n_female / (n_female + n_male)
    ) %>%
    arrange(desc(prop_female)) %>%
    knitr::kable()
}

#######

sys_auths <- roles %>% 
  filter(role == "author") %>% 
  left_join(persons, by = c("name" = "name", "gs_email" = "gs_email")) %>% 
  dplyr::select(name, gender, key, as_author) %>% 
  mutate(conf = as.factor(gsub("_\\d\\d\\d$", "", key))) %>% 
  left_join(all_confs, by = c("conf" = "conference")) %>% 
  rename(key = key.x) %>% 
  dplyr::select(name, gender, key, field, subfield, as_author)

nonsys_auths <- nonsys_authors %>% 
  dplyr::select(-conf, -n_submissions) %>% 
  dplyr::select(name, gender, paper_id, field, subfield) %>% 
  rename(key = paper_id) %>% 
  add_count(name) %>% 
  rename(as_author = n)

full_auths <- bind_rows(sys_auths, nonsys_auths)

full_auths$subfield = recode_factor(full_auths$subfield,
                                    "Heterogeneous Computing" = "Computer Architecture",
                                    "Virtualization" = "Operating Systems",
                                    "Energy" = "Computer Architecture",
                                    "Architecture" = "Computer Architecture")

full_auths$field = recode_factor(full_auths$field,
                                 "Systems" = "Computer Systems",
                                 "Computer Science Education" = "CS Education",
                                 "Artificial Intelligence" = "AI",
                                 "Human-Computer Interaction" = "HCI",
                                 "Theory and Algorithms" = "Theory",
                                 "Software Engineering & Languages" = "SE/languages")

gen_auths <- full_auths %>% drop_na(gender)

cwomen <- "#7704FF"
cmen <- "#00C3AA"
cmen <- "gray70"
cwomen <- "gray30"

#######
productivity_diff <- function(sf)
{
  men <- filter(gen_auths, gender == "M", subfield == sf)
  women <- filter(gen_auths, gender == "F", subfield == sf)
  paste0(round(mean(men$as_author) - mean(women$as_author), 2), "; ",
         report_test(t.test(men$as_author, women$as_author)))
}
```

# Introduction

The gender gap in science, technology, engineering and mathematics (STEM), and in particular in computer science (CS), is a well-known and well-studied problem.
It carries significant societal effects, such as inequality in economic opportunities for women and an undersupply of researchers and engineers in the rapidly growing discipline [@nielsen17:opinion; @mattis07:upstream].
The gender gap among researchers is particularly severe: the people who participate in research, publish about it, and have their research acknowledged for its value are predominantly men [@charman17:championing].
Numerous studies estimate that only about 15%--30% of the CS research community are women [@cohoon11:cspapers; @holman18:gender; @national20:science; @way16:gender; @zweben18:taulbee].
Although some recent indications show these numbers could be growing, they remain low, and the rate of growth remains slow [@wang21:trends].

The gender gap is a complex, multifaceted challenge [@avolio20:factors].
Numerous approaches to understand and perhaps address the gender gap have focused on facets such as resource availability, gender stereotypes, child care, structural barriers, gender differences, discrimination, and other factors.
This article focuses on one of these factors: the collaboration patterns of paper coathors across genders and CS fields.

Scientific collaborations are the backbone of a successful career in science [@whittington18:tie].
For example, researchers with more collaborators have been found to publish more articles, in higher impact journals, and accrue more citations more quickly [@lee05:impact].
Consequentlly, many studies investigated whether women and men collaborate at different rates across discplines, and often found significant differences [@bozeman04:scientists; @hunter08:collaborative; @kyvik96:child; @scott90:disadvantage].

In CS, and in particular in its more experimental fields such as computer systems, graphics, and artificial intelligence (AI), collaboration is crucial because the large-scale implementation efforts involved often require teams of researchers with various experience levels.
In this article we focus on gender differences in collaboration patterns across the fields and subfields of CS.

Our study design is descriptive and observational in nature.
We did not start out with any preset hypotheses to validate.
Instead, our goal was to collect and analyze up-to-date, accurate and extensive data on CS authorship and collaboration patterns across genders.
This data and analysis provides baseline statistics for comparison across different time points and scientific disciplines.
But it also provides immediate answers and comparisons to other works that can provide new insights into the current state of collaboration differences across genders and CS fields.
Specifically, in this article we address the following research questions:

 *  **RQ0**: What are the ratios of women and men among CS conference authors?
 
 *  **RQ1**: Do women publish less than men?

 *  **RQ2**: Do women collaborate with fewer people than men?

 *  **RQ3**: Does collaboration amount vary by the gender of the collaborators?

 *  **RQ4**: Are cross-gender collaborations in our dataset fewer than expected?

 *  **RQ5**: Do women publish fewer single-author papers?

 *  **RQ6**: Are team sizes (coauthor groups) larger in more experimental subfields?

 *  **RQ7**: What is the relationship between the cost of the system investigated and gender and collaboration patterns?

To bring these questions into historical context, we briefly survey some of the previous work in the area next.

## Related work {-}

There exists a very rich literature on the gender gap in sciences in general, and in computer science research in particular.
For a recent review of this literature, refer to [@avolio20:factors].
Instead, we limit our focus to the relevant literature on collaboration patterns and differences.

For example, a recent study of differences in collaboration patterns across disciplines found that female scientists have a lower probability of repeating previous coauthors than males.
It also found that female faculty have significantly fewer distinct coauthors over their careers than males, but that this difference can be fully accounted for by femalesâ€™ lower publication rate and shorter career lengths [@zeng16:differences].

This productivity gap, which we observed in our dataset as well, has been thoroughly explored in a different study [@symonds06:gender].
In the social sciences, one study has found that women generally publish fewer papers than men, and that two thirds of the single-author papers were written by men [@schucan11:women].
In mathematics, women also publish less than men, especially early in their careers, and leave academia at a higher rate then men [@mihaljevic16:effect].
Women are also underrepresented in the three top-ranked journals and publish fewer single-author papers. In terms of mean number of coauthors, women's statistics are similar to men's.
There is even a gap in recognition, as women are also less likely to receive tenure the more they coauthor [@sarsons17:recognition].




CS researchers in particular tend to collaborate more than researchers in other fields, regardless of gender, and there are no gender-specific differences in how collaborative behavior impacts scientific success [@jadidi18:gender].
This study also found that gender homophily in CS has been increasing over the past few years.

Related, another study of collaboration patterns across sciences found that CS papers average 2.84 coauthors, and electrical engineering papers average 3.04 [@ghiasi15:compliance], similar to what we have found in this study.
It also found that generally in engineering, female-female collaborations accounted for only 7% of all total pairs.
In CS, the percentage is even lower (5%).
Since 1990, there have been even more same-gender (gender homophily) coauthorships than expected [@wang21:trends].
But this property can vary across CS fields, necessitating more nuanced analysis.
For example, in the field of data visualization, women collaborated with subtantially more women than men [@tovanich21:gender].

Corroborating this result for biotech patent networks, women have been found more likely to collaborate with women, and benefit from it, but both genders collaborate with mostly men [@whittington18:tie].
There are also fewer women "stars", which we also found to hold for computer systems with h-index and npubs [@frachtenberg21:underrepresentation].

A surprising result came from a survey of 1,714 scientists in 2011, finding that when accounting for various confounding factors, women actually have more collaborators then men [@bozeman11:men].
The paper also reported that regression models that take into account different collaboration strategies are better at predicting a researcher's number of collaborators.

Several studies analyzed the gender gap by aggregating the coauthors of each paper into one "gender".
One study analyzed different aggregations based the proportion of female authors, gender of most senior authors, and single-author papers [@hengel17:publishing].
Looking at author position for aggregation, another study found that there are fewer women in first and last author positions in science overall, as well as in single-author papers [@west13:role].
Other ways to aggregate genders including counting all papers that have at least one female author, and those where at least half the authors are female.


## Organization {-}

The rest of this paper is organized as follows.
In the next section (Sec. \@ref(sec:data)), we describe in detail our data collection methodology, including the manual assigment of genders to authors to avoid the well-known issues of name-based gender inference.
In the results section (Sec. \@ref(sec:results)), we enumerate our findings, organized by research question, and then summarize an answer to each of the questions.
The discussion (Sec. \@ref(sec:discussion)) that follows then elaborates on these answers in an attempt to synthesize insights.
Finally, we conclude in Sec. \@ref(sec:conclusion) and suggest directions for future research.

<!-------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------->

# Materials and Methods {#sec:data}

## Limitations {-}

The data reflects a snapshot in time, not annual trend, to avoid complexities of gender differences in drop-out rates.

Network analysis and patterns are outside the scope of this paper; more descriptive than prescriptive, a basis for future work.

Manual data.


TODO: Add mapping table/list from subfield to field.

```{r echo=F, cache=T}
# this is all nonsys conferences
nonsys_full_table <- nonsys_authors %>%
  group_by(conf) %>%
  mutate(Papers = n_distinct(paper_id, conf), Authors = n_distinct(name, conf, na.rm = T)) %>%
  distinct(conf, .keep_all = T) %>%
  ungroup() %>%
  mutate(Acceptance = round(Papers / n_submissions, 2)) %>%
  mutate(Conference = gsub("_\\d*", "", conf)) %>%
  dplyr::select(Conference, subfield, field, Papers, Authors, Acceptance) %>%
  rename(Field = field, Subfield = subfield)

# this is all other conferences
sys_full_table <- all_confs %>%
  mutate(Conference = gsub("_\\d*", "", conference)) %>%
  rename(Papers = npapers, Authors = authors_num, Field = field, Subfield = subfield) %>%
  mutate(Acceptance = round(acceptance_rate, 2)) %>%
  dplyr::select(Conference, Subfield, Field, Papers, Authors, Acceptance)

full_table <- dplyr::bind_rows(nonsys_full_table, sys_full_table) %>%
  arrange(Subfield, Acceptance)

full_table %>%
  dplyr::select(-c(Field)) %>%
  mutate(Acceptance = ifelse(is.na(Acceptance), "Unknown", Acceptance)) %>%
  knitr::kable(format = "latex",
               booktabs = T,
               align = "llrrr",
               linesep = "",
               caption = "All conferences, ordered by acceptance rate, per subfield") %>%
  kable_styling(latex_options = c("hold_position"), font_size = 7)
```

We have very few NA genders because of our approach.
Lots of other studies omit "ambiguous" names, which tend to skew Asian (and more female [@cite]).
Many gender-based studies that omit NAs justify their decision with substantively unchanged models [for example, @cite].
But when analyzing networks, omitting a large number of connected sub-networks (such as Asians) may distort our results.
So it's important that we only have a few NAs, and omitting them doesn't change much (do sensitivity testing!)

<!-------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------->

# Results {#sec:results}

For each research question, we start with descriptive statistics across the entire sample population, and then break the statistics down by field and subfield.

## RQ0 What are the ratios of women and men among CS conference authors?

Before we can look at collaboration patterns, we need to establish a baseline for authorship numbers across genders.
For example, the question of how many women or men an author collaborates with makes little sense without the context of how many women and men are available to collaborate with overall.
The first question we ask, therefore, is what is the female author ratio (FAR) in our dataset.

Summarizing across all `r fmt(nrow(full_auths))` authors and omitting the `r fmt(sum(is.na(full_auths$gender)))` authors for which we could establish no gender, we find a total of `r fmt(sum(gen_auths$gender == "F"))` women, which represents an overall FAR of
`r pct(sum(gen_auths$gender == "F"), nrow(gen_auths))`% across unique authors.
This result is on the low end of previously reported statistics in the range of 15--30% [@cohoon11:cspapers; @holman18:gender; @national20:science; @way16:gender; @zweben18:taulbee].
Keep in mind, however, the differences between those studies and this one, both in data and in methodology.
Our data is modest in size when compared to most other studies, and includes only conferences and only from one year.
Our selection of conferences is by no means exhaustive or objective, and is likely to be overweight in some areas of CS and underweight in others.
However, the smaller sample size allowed us to apply a primarily manual approach to gender assignment, which provides higher accuracy and coverage of researchers.
In contrast, most comparable studies use a gender inference approach based on given names, which can fail for names with unclear or no gender association at all, as are many East Asian names, and tend to misidentify women in particular [@cohoon11:cspapers; @mattauch20:bibliometric; @santamaria18:comparison].
We believe these two differences can explain much of the gap between the FARs observed in our data and in previous datasets.

```{r FAR-by-subfield, echo=F, warning=F, message=F, cache=T, out.width='0.95\\textwidth', fig.cap="Female author ratio by subfield"}
gen_auths %>%
  group_by(subfield) %>%
  summarize(FAR = sum(gender == "F") / n(), N = n(), field = first(field), subfield = first(subfield)) %>%
  ggplot(aes(x = fct_reorder(subfield, FAR), y = FAR, fill = field)) +
    geom_bar(stat = "identity") +
    geom_text(aes(x = fct_reorder(subfield, FAR), y = 0.42, label = paste0(subfield, "  N=", fmt(N))), hjust = 1, angle = 0, size = 3) +
    xlab("Subfield") +
    ylab("Female author ratio") +
    labs(fill = "") +
    coord_flip() +
    scale_fill_brewer(palette = "Paired") +
    theme_minimal() +
    theme(legend.position = "bottom",
#          legend.justification = c(0, 0),
          axis.text.y = element_blank(),
          #element_text(angle = 90, hjust = 1, vjust = -0.00001),
          legend.box = "vertical",
          legend.margin = margin())
```

Looking at FAR for each field and subfield (Fig. \@ref(fig:FAR-by-subfield)), we find large differences across CS.
The highest FAR was exhibited in CS education conferences
(`r pct(nrow(filter(gen_auths, gender == "F", subfield == "Computer Science Education")), nrow(filter(gen_auths, subfield == "Computer Science Education")))`%)
and the lowest in theoretical CS
(`r pct(nrow(filter(gen_auths, gender == "F", subfield == "Theoretical Computer Science")), nrow(filter(gen_auths, subfield == "Theoretical Computer Science")))`%).
Most conferences in the field of computer systems hovered around 10% FAR while the entire field AI averaged a little higer at
(`r pct(nrow(filter(gen_auths, gender == "F", field == "AI")), nrow(filter(gen_auths, field == "AI")))`%).



---

## RQ1: Do women publish less than men?

Many papers across disciplines discuss the existence and potential reasons for a productivity gap, that is, the observation that men generally publish more scholarly articles than women.
Here, we continue our exploration of the data by looking at the productivity rates across genders and subfields of CS.


```{r productivity-dist, echo=F, warning=F, message=F, cache=T, fig.cap="Distribution of number of distinct papers per author"}
gen_auths %>%
  ggplot(aes(x = as_author, fill = gender)) +
    geom_histogram(position = "dodge", binwidth = 1) +
    scale_fill_manual(values = c(cwomen, cmen), labels = c("Women", "Men")) +
    theme_classic() +
    theme(legend.position = "bottom") +
    xlab("Papers in dataset") +
    ylab("Total authors")
```

Fig. \@ref(fig:productivity-dist) shows the overall distributions of paper productivity in CS across genders.
Aside from the now-obvious observation that men far outnumber women authors overall, we can also observe a longer tail for the men's distribution overall.
The interpretation is that the most prolific authors are especially skewed male.
On the opposite tail, we find that
`r pct(nrow(filter(gen_auths, gender == "F", as_author == 1)), nrow(filter(gen_auths, gender == "F")))`%
of female authors published only one paper in our dataset, compared to
`r pct(nrow(filter(gen_auths, gender == "M", as_author == 1)), nrow(filter(gen_auths, gender == "M")))`%
of men.

Overall, men average
`r round(mean(filter(gen_auths, gender == "M")$as_author), 2)`
papers per author, compared to women's
`r round(mean(filter(gen_auths, gender == "F")$as_author), 2)`
(`r report_test(t.test(filter(gen_auths, gender == "F")$as_author, filter(gen_auths, gender == "M")$as_author))`).
Looking at medians---to attempt to attenuate the large effect of the long tail on means---does not help much.
Both medians are 1; but a Wilcoxon signed rank test still shows a significant difference
(`r report_test(wilcox.test(filter(gen_auths, gender == "F")$as_author, filter(gen_auths, gender == "M")$as_author))`).


```{r productivity-by-subfield, echo=F, warning=F, message=F, cache=T, fig.height = 8, fig.cap="Distribution of number of distinct papers per author by gender, field, and subfield. Triangles denote means and veritcal notches denote medians. Dots denote outlier points outside the 5--95% range."}
legend_ord <- c("AI", "HCI", "Knowledge Systems", "Computer Systems", "SE/languages", "Theory", "CS Education")

gen_auths %>%
  group_by(subfield) %>%
  mutate(avg_prod = mean(as_author), N=n()) %>%
  ungroup() %>%
  ggplot(aes(x = fct_reorder(subfield, avg_prod), y = as_author, fill = gender, color = field)) +
    geom_boxplot(lwd = 0.5) +
    geom_point(aes(y = avg_prod), color = "black", shape = 2) +
#    geom_text(aes(x = fct_reorder(subfield, avg_prod), y = 21, label = paste0("N=", N)), hjust = 1.1) +
    xlab("Subfield") +
    ylab("Paper count per author") +
    theme_classic() +
    theme(legend.position = "bottom", legend.box = "vertical") +
    guides(fill = guide_legend(direction = 'horizontal', title = "Gender"),
           color = guide_legend(direction = 'horizontal', title = "Field")) +
    scale_fill_manual(values = c(cwomen, cmen), labels = c("Women", "Men")) +
    scale_color_brewer(palette = "Paired") +
    coord_flip()
```



Fig. \@ref(fig:productivity-by-subfield) shows the breakdown of productivity distribution by gender, field, and subfield.
The field of AI and its subfields show the highest average productivity (and highest outliers, for men), while software engineering, programming languages, and CS education exhibit the lowest average papers per author.
In terms of gender, the largest differences in productivity exhibit in the subfield of theoretical CS (difference in means: `r productivity_diff("Theoretical Computer Science")`), followed by machine learning (`r productivity_diff("Machine Learning")`), benchmarking (`r productivity_diff("Benchmarking")`), HPC (`r productivity_diff("High-Performance Computing")`), security (`r productivity_diff("Security")`), and AI (`r productivity_diff("Artificial Intelligence")`).
A few subfields show a small productivity advantage for women, such as programming languages (`r productivity_diff("Programming Languages")`), but none are statistically significant.


---


## RQ2: Do women collaborate with fewer people than men?

This question could be addressed by two distinct measures.

The first measure is the mean number of coauthors per paper.
Women in our dataset average
`r coauthor_count <- all_pairs %>% group_by(paper_id, name1, gender1) %>% summarize(.groups = "keep", n = n()); round(mean(filter(coauthor_count, gender1 == "F")$n), 2)`
coauthors, while men average
`r round(mean(filter(coauthor_count, gender1 == "M")$n), 2)`
(`r report_test(t.test(filter(coauthor_count, gender1 == "F")$n, filter(coauthor_count, gender1 == "M")$n))`).

The second measure is how many distinct authors each person collaborates with across all of their papers---in other words, the size of the cohort of all a person's collaborators.
In our dataset, women average
`r cohorts <- all_pairs %>% group_by(name1, gender1) %>% summarize(.groups = "keep", cohort = n_distinct(name2, gender2)); round(mean(filter(cohorts, gender1 == "F")$cohort), 2)`
total cohort size, while men average
`r round(mean(filter(cohorts, gender1 == "M")$cohort), 2)`
(`r report_test(t.test(filter(cohorts, gender1 == "F")$cohort, filter(cohorts, gender1 == "M")$cohort))`).



```{r echo=F, eval=F}
nonsys_authors %>%
  group_by(conf) %>%
  gender_summary_table()


nonsys_authors %>%
  group_by(field) %>%
  gender_summary_table()

nonsys_authors %>%
  group_by(subfield) %>%
  gender_summary_table()

author_order_data <- nonsys_authors %>%
  add_count(conf, paper_id) %>%
  filter(n > 1) %>%
  dplyr::select(-n) %>%
  group_by(paper_id) %>%
  mutate(author_order = row_number(paper_id)) %>%
  ungroup()

author_order_data %>%
  filter(author_order == 1) %>%
  group_by(field) %>%
  summarise(.groups = "keep",
    n_female_fa = sum(gender == "F", na.rm = T),
    n_male_fa =  sum(gender == "M", na.rm = T),
    prop_female_fa = n_female_fa / (n_female_fa + n_male_fa)
  ) %>%
  arrange(desc(prop_female_fa)) %>%
  knitr::kable()

author_order_data %>%
  group_by(conf, paper_id) %>%
  filter(author_order == max(author_order)) %>%
  ungroup() %>%
  group_by(field) %>%
  summarise(.groups = "keep",
    n_female_la = sum(gender == "F", na.rm = T),
    n_male_la =  sum(gender == "M", na.rm = T),
    prop_female_la = n_female_la / (n_female_la + n_male_la)
  ) %>%
  arrange(desc(prop_female_la)) %>%
  knitr::kable()
```



```{r echo=F, eval=F}
# average coauthor team size by gender
nonsys_authors %>%
  add_count(conf, paper_id) %>%
  mutate(n_coauthors = n - 1) %>%
  dplyr::select(-n) %>%
  dplyr::select(name, paper_id, n_coauthors) %>%
  left_join(all_genders, by = 'name') %>%
  filter(!is.na(gender)) %>%
  group_by(gender) %>%
  summarise(.groups = "keep", mean_number_of_coauthors = mean(n_coauthors)) %>%
  knitr::kable()
```



```{r echo=F, eval=F}
author_collaboration_counts <- nonsys_collaboration_pairs %>%
  left_join(all_genders, by = c("name2" = "name")) %>%
  rename(genderp2 = gender) %>%
  dplyr::select(name1, name2, genderp2, -paper_id) %>%
  group_by(name1) %>%
  summarise(.groups = "keep",
    n_female_collaborators = sum(genderp2 == "F"),
    n_male_collaborators = sum(genderp2 == "M")
    ) %>%
  mutate(n_total = n_female_collaborators + n_male_collaborators) %>%
  left_join(all_genders, by = c("name1" = "name")) %>%
  dplyr::select(name1, gender, n_female_collaborators, n_male_collaborators, n_total) %>%
  rename(genderp1 = gender) %>%
  filter(!is.na(genderp1))


# average number of male and female collaborators also broken down by gender
author_collaboration_counts %>%
  group_by(genderp1) %>%
  summarise(.groups = "keep",
    avg_n_female_collaborators = round(mean(n_female_collaborators, na.rm = T), 2),
    avg_n_male_collaborators = round(mean(n_male_collaborators, na.rm = T), 2)
    ) %>%
  knitr::kable()
```

---

## RQ3: Does collaboration amount vary by the gender of the collaborators?

---

## RQ4: Are cross-gender collaborations in our dataset fewer than expected?

---

## RQ5: Do women publish fewer single-author papers?

```{r echo=F, eval=F}
# percent sole authors by gender
total_male_authors <- nonsys_authors %>%
  count(gender) %>%
  filter(gender == "M") %>%
  pull(n)

total_female_authors <- nonsys_authors %>%
  count(gender) %>%
  filter(gender == "F") %>%
  pull(n)

# solo authorship
nonsys_authors %>%
  add_count(conf, paper_id) %>%
  filter(n == 1) %>%
  filter(!is.na(gender)) %>%
  count(gender) %>%
  mutate(
    percent_solo = case_when(
      gender == "M" ~ round((n/total_male_authors), 4) * 100,
      gender == "F" ~ round((n/total_female_authors), 4) * 100
    )
  ) %>%
  dplyr::select(-n) %>%
  knitr::kable()

# 


# dual authorship
nonsys_authors %>%
  add_count(conf, paper_id) %>%
  filter(n == 2) %>%
  filter(!is.na(gender)) %>%
  count(gender) %>%
  mutate(
    percent_dual = case_when(
      gender == "M" ~ round((n/total_male_authors), 4) * 100,
      gender == "F" ~ round((n/total_female_authors), 4) * 100
    )
  ) %>%
  dplyr::select(-n) %>%
  knitr::kable()
```

---

## RQ6: Are team sizes larger in more experimental subfields?

---

## RQ7: Are gender and collaboration patterns related to experimental costs?

# average number of collaborators by gender
author_collaboration_counts %>%
  group_by(genderp1) %>%
  summarise(.groups = "keep", avg_n_collaborators = round(mean(n_total, na.rm = T), 2)) %>%
  knitr::kable()

# average number of male and female collaborators also broken down by gender
author_collaboration_counts %>%
  group_by(genderp1) %>%
  summarise(.groups = "keep",
    avg_n_female_collaborators = round(mean(n_female_collaborators, na.rm = T), 2),
    avg_n_male_collaborators = round(mean(n_male_collaborators, na.rm = T), 2)
    ) %>%
  knitr::kable()
```

---

<!-------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------->

# Discussion {#sec:discussion}

Correlate all variables:

 * Do normalized productivity as well: divided by the number of coauthors per paper, so each author gets a fraction.

 * Relationship between anything and FAR, speculate on causality and "whysofew"
 
 * Theoretical CS is an extreme point by almost all metrics, and matches what [@mihaljevic16:effect] found for math.

<!-------------------------------------------------------------------------------->
<!-------------------------------------------------------------------------------->

# Conclusions {#sec:conclusion}

Future work: network analyses, such as degree centraility; evolution of patterns over time.
